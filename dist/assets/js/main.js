!function(n){var e={};function t(c){if(e[c])return e[c].exports;var l=e[c]={i:c,l:!1,exports:{}};return n[c].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=n,t.c=e,t.d=function(n,e,c){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:c})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var c=Object.create(null);if(t.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var l in n)t.d(c,l,function(e){return n[e]}.bind(null,l));return c},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./src/modules/Video.js\n//ensure <script src=\"https://player.vimeo.com/api/player.js\"><\/script> is included on page\n\nlet Video = function( id, $ele ){\n  let opts = {\n    id: id,\n    width: window.innerWidth,\n    autoplay: false,\n    controls: false,\n    muted: true\n  };\n  this.vimeo = new Vimeo.Player( $ele, opts );\n  this.volume = 0;\n  this.vimeo.setVolume( this.volume );\n  this.progress = 0;\n  this.length = 0;\n  this.vimeo.getDuration().then(duration => this.length = duration);  \n  this.fadeLoop = false;\n  this.vimeo.on('ended', ( ) => {\n    this._onEnded();\n  });\n  this.vimeo.on('timeupdate', ( t ) => {\n    this.progress = t.seconds / t.duration;\n    if( typeof this.onProgress === 'function' ){\n      this.onProgress();\n    }\n    if( t.seconds >= t.duration - 2 ){\n      this._onEnded();\n    }\n  });\n}\n\nlet proto = Video.prototype;\n\nproto._onEnded = function(){\n  if( typeof this.onEnded === 'function' ){\n    this.onEnded();\n  }\n}\n\nproto.play = function(){\n  this.vimeo.play();\n}\n\nproto.pause = function(){\n  this.vimeo.pause();\n}\n\nproto.getProgress = function(){\n  return this.progress;\n}\n\nproto._onFadedIn = function(){\n  if( typeof this.onFadedIn === 'function' ){\n    this.onFadedIn();\n  }\n}\n\nproto.fadeIn = function( _time, _callback ){  \n  let time = _time || 100;\n  let callback = _callback || function(){};\n  clearInterval( this.fadeLoop );\n  let change = 1 - this.volume;\n  let step = change / (time / 10);\n  this.fadeLoop = setInterval(() => {\n    this.volume += step;\n    if( this.volume >= 1 ){\n      this.volume = 1; \n      this._onFadedIn();\n      callback();\n      clearInterval( this.fadeLoop );\n    }    \n    this.vimeo.setVolume( this.volume );\n  }, 10 );\n};\n\nproto._onFadedOut = function(){\n  if( typeof this.onFadedOut === 'function' ){\n    this.onFadedOut();\n  }\n}\n\nproto.fadeOut = function( _time, _callback ){  \n  let time = _time || 100;\n  let callback = _callback || function(){};  \n  clearInterval( this.fadeLoop );\n  let change = -this.volume;\n  let step = change / (time / 10);  \n  this.fadeLoop = setInterval(() => {\n    this.volume += step;\n    if( this.volume <= 0 ){\n      this.volume = 0; \n      this._onFadedOut();\n      callback();\n      clearInterval( this.fadeLoop );\n    }\n    this.vimeo.setVolume( this.volume );\n  }, 10 );\n};\n\nproto.update = function( fraction ){\n\n}\n/* harmony default export */ var modules_Video = (Video);\n// CONCATENATED MODULE: ./src/modules/Screen.js\n\n\nlet Screen = function( $ele ){\n  this.$ele = $ele;\n  this.$content = $ele.querySelector('.screen--content');\n  this.active = false;\n  this.type = '';\n  if( this.$ele.classList.contains( 'screen__text__credits' ) ){\n      this.type = 'credits';\n  } else if( this.$ele.classList.contains( 'screen__video' ) ){\n    this.type = 'video';    \n    this.video = new modules_Video( this.$content.dataset.vimeo_id, this.$content );\n    this.video.onProgress = () => {\n      this._onProgress();\n    };\n    this.video.onEnded = () => {\n      this.deactivate();\n      this.screenAfter.activate();\n    }\n  } else {\n    this.type = 'text';\n  }\n  this.scrollProgress = 0;\n  this.scrollProgressFrac = 0;\n  this.scrollMax = ( this.type === 'credits' ) ? this.$ele.scrollHeight : this.$ele.offsetHeight*0.65;  \n  this.scrollMin = ( this.type === 'credits' ) ? this.$ele.offsetHeight * -0.1 : 0;\n}\n\nlet Screen_proto = Screen.prototype;\n\nScreen_proto.linkToOthers = function( before, after ){\n  this.screenBefore = before;\n  this.screenAfter = after;\n}\n\nScreen_proto._onProgress = function(){\n  if( typeof this.onProgress === 'function' && this.active ){\n    this.onProgress();\n  }\n}\n\nScreen_proto._onActivated = function(){\n  if( typeof this.onActivated === 'function' ){\n    this.onActivated( this );\n  }\n}\n\nScreen_proto._onActivateStart = function(){\n  if( typeof this.onActivateStart === 'function' ){\n    this.onActivateStart( this );\n  }\n}\n\nScreen_proto.preload = function(){\n  if( this.type === 'video' ){\n    this.video.play();    \n  }\n}\n\nScreen_proto.activate = function( _callback ){\n  let callback = _callback || function(){};\n  this._onActivateStart();\n  this.active = true;\n  this.$ele.classList.add( 'active' );\n  this.scrollProgress = 0;\n  this.scrollProgressFrac = 0;  \n  if( this.type === 'video' ){\n    this.video.play();\n    this.video.fadeIn(1500, () => {\n      this._onActivated();\n      callback();\n    });    \n  } else if( this.type === 'credits' ){\n    this.$content.scrollTop = 0;\n    this._onActivated();\n    callback();\n  } else {\n    this._onActivated();\n    callback();\n  }\n  this.update();\n}\n\nScreen_proto.deactivate = function( _callback ){\n  let callback = _callback || function(){};\n  this.active = false;\n  this.$ele.classList.remove('active');\n  if( this.type === 'video' ){\n    this.video.fadeOut( 1500, () => {\n      this.video.pause();\n      callback();\n    });\n  } else{\n    callback();\n  }\n}\n\n\nScreen_proto.scroll = function( delta ){\n  if( this.active ){\n    this.scrollProgress += delta;\n    if( this.scrollProgress < this.scrollMin -10 ){\n      this.scrollProgress = this.scrollMin -10;\n    } else if( this.scrollProgress > this.scrollMax + 10 ){\n      this.scrollProgress = this.scrollMax + 10;\n    }\n    this.scrollProgressFrac = this.scrollProgress/this.scrollMax;\n    if( this.scrollProgressFrac > 0.75 && this.screenAfter ){\n      this.deactivate( () => {\n        this.screenAfter.activate();\n      });      \n    } else if( this.scrollProgressFrac < this.scrollMin / this.scrollMax && this.screenBefore ){\n      this.deactivate( () => {\n        this.screenBefore.activate();\n      });      \n    }\n    if( this.scrollProgressFrac > 0.25 && this.screenAfter.type === 'video' ){\n      this.screenAfter.preload();\n    } \n  }\n}\n\nScreen_proto.resize = function(){\n  this.scrollProgressFrac = this.scrollProgress/this.scrollMax;\n  this.scrollMax = ( this.type === 'credits' ) ? this.$ele.scrollHeight : this.$ele.offsetHeight;\n  this.scrollProgress = this.scrollProgressFrac * this.scrollMax;\n}\n\nScreen_proto.update = function(){\n  if( this.type === 'video' ){\n    this.video.update( this.scrollProgressFrac );\n    if( this.scrollProgressFrac > 0.75 ){\n      this.$content.style.opacity = (0.25 - (this.scrollProgressFrac - 0.75)) * (1/0.25);\n    } else {\n      this.$content.style.opacity = 1;\n    }\n  } else {\n    this.$content.style.opacity = (1 - this.scrollProgressFrac);\n  }\n\n  \n}\n\n/* harmony default export */ var modules_Screen = (Screen);\n// CONCATENATED MODULE: ./src/modules/Progress.js\nlet Progress = function( $ele, currentScreen, stageIndex ){\n  this.$ele = $ele;\n  this.$indicator = this.$ele.querySelector('.progress--indicator');\n  this.$stages = this.$ele.querySelectorAll('.progress--stage');\n  this.setIndicatorTransition( false );\n  this.setCurrent( currentScreen, stageIndex );\n  this.initInteraction();\n  this.hideTimeout = false;\n  this.hideDelay = 3000;\n}\n\nlet Progress_proto = Progress.prototype;\n\nProgress_proto.hide = function( delay ){\n  clearTimeout( this.hideTimeout );\n  if( delay ){\n    this.hideTimeout = setTimeout(() => {\n      this.$ele.classList.add('state__hidden');\n    }, delay );\n  } else {\n    this.$ele.classList.add('state__hidden');\n  }\n}\nProgress_proto.show = function(){\n  clearTimeout( this.hideTimeout );\n  this.$ele.classList.remove('state__hidden');\n}\n\nProgress_proto._onStageSelect = function( index, id ){\n  if( typeof this.onStageSelect === 'function' ){\n    this.onStageSelect( index, id );\n  }\n}\n\nProgress_proto.initInteraction = function(){\n  this.$ele.querySelectorAll('a').forEach(( $a, i  ) => {\n    $a.addEventListener('click', () => {\n      let id = $a.href.replace(window.location.origin,'').replace('/', '').replace('#','');\n      this._onStageSelect( i, id );\n    });\n  });\n  \n  document.addEventListener('mousemove', () => {\n    clearTimeout( this.hideTimeout );\n    this.show();\n    if( this.currentScreen.type === 'video' ){\n      this.hide( this.hideDelay );\n    }\n  });\n  document.addEventListener('wheel', ( e ) => {\n    clearTimeout( this.hideTimeout );\n    this.show();\n    if( this.currentScreen.type === 'video' ){\n      this.hide( this.hideDelay );\n    }\n  });\n};\n\nProgress_proto.setCurrent = function( currentScreen, stageIndex ){\n  this.currentScreen = currentScreen;\n  this.$currentStage = this.$stages[ stageIndex ];\n  this.moveIndicator();\n  if( this.currentScreen.type === 'video' ){\n    this.hide( this.hideDelay );\n    this.currentScreen.onProgress = () => {\n      this.moveIndicator();\n    }\n  } else {\n    this.show();\n  }\n}\n\nProgress_proto.setIndicatorTransition = function( to, delay ){\n  clearTimeout( this.indicatorTransitionToggleTimeout );\n  if( !!delay && delay > 0 ){\n    this.indicatorTransitionToggleTimeout = setTimeout(() => {\n      if( to ){\n        this.$indicator.classList.add('transition-active');\n      } else {\n        this.$indicator.classList.remove('transition-active');\n      }\n    }, delay )\n  } else {\n    if( to ){\n      this.$indicator.classList.add('transition-active');\n    } else {\n      this.$indicator.classList.remove('transition-active');\n    }\n  }\n  this.indicatorTransition = to;\n}\n\nProgress_proto.moveIndicator = function(){\n  let translateX = 0;\n  if( this.currentScreen.type === 'video' ){\n    let progress = this.currentScreen.video.getProgress();\n    let x = this.$currentStage.offsetLeft;\n    let max = this.$currentStage.offsetWidth;\n    translateX = x + (progress * max);    \n  } else {\n    translateX = this.$currentStage.offsetLeft;\n  }\n  this.$indicator.style.transform = 'translateX(' + translateX + 'px)';\n}\n\n/* harmony default export */ var modules_Progress = (Progress);\n// CONCATENATED MODULE: ./src/modules/Controls.js\nlet Controls = function( $ele ){\n  this.$ele = $ele;\n  this.$fullscreen = this.$ele.querySelector('.fullscreen');\n  this.$mute = this.$ele.querySelector('.mute')\n  this.$subs = this.$ele.querySelector('.subtitles')\n\n  this.$fullscreen.addEventListener( 'click', function(){\n    if (!document.fullscreenElement) {\n      document.querySelector('.site-wrap')\n        .requestFullscreen({ navigationUI: \"hide\" })\n        .catch( ( err ) => {\n          alert('no fullscreen');\n        })\n    } else {\n      document.exitFullscreen();\n    }\n  });\n}\n\n\n\nlet Controls_proto = Controls.prototype;\n\n/* harmony default export */ var modules_Controls = (Controls);\n// CONCATENATED MODULE: ./src/main.js\n\n\n\n\nlet screens = [];\ndocument\n  .querySelectorAll('.screen')\n  .forEach(function( $s ){\n    screens.push( new modules_Screen( $s ) );\n  });\n\nfor( let i = 0; i < screens.length; i++ ){\n  let before = i > 0 ? screens[i-1] : false;\n  let after = i < screens.length - 1 ? screens[i+1] : false;  \n  screens[i].linkToOthers( before, after ); \n}\n\nwindow.screens = screens;\n\nlet currentScreenIndex = 0;\nlet pScreenIndex = 0;\nlet currentStageIndex = Math.floor( currentScreenIndex / 2 );\nlet currentScreen = screens[currentScreenIndex];\n\nlet progress = new modules_Progress( document.querySelector('.progress--bar'), currentScreen , currentStageIndex );\nlet controls = new modules_Controls( document.querySelector('.controls') );\n\n\nlet stageSelectTimeout = false;\nprogress.onStageSelect = function( index, id ){\n  if( index !== currentStageIndex ){\n    clearTimeout(stageSelectTimeout);\n    currentScreen.deactivate();\n   \n    stageSelectTimeout = setTimeout(function(){\n      currentScreenIndex = index * 2;\n      currentStageIndex = index;\n      currentScreen = screens[currentScreenIndex];\n      currentScreen.activate();\n      progress.setIndicatorTransition( true );\n      progress.setCurrent( currentScreen, currentStageIndex );\n      progress.setIndicatorTransition( false, 1500 );\n    }, 300 );\n  }\n}\n\ncurrentScreen.activate();\n\nfor( let i = 0; i < screens.length; i++ ){\n  screens[i].update();\n  (function( index ){\n    screens[index].onActivateStart = function( s ){\n      let previousScreen = currentScreen;\n      currentScreenIndex = index;\n      currentStageIndex = Math.floor( currentScreenIndex / 2 );\n      currentScreen = screens[index];\n      if( previousScreen && previousScreen.type === 'video' && currentScreen.type !== 'video'){\n        progress.setIndicatorTransition( true );\n        progress.setIndicatorTransition( false, 1500 );\n      }\n      progress.setCurrent( currentScreen, currentStageIndex );\n    };\n    screens[index].onActivated = function( s ){\n         \n      if( s.type === 'video' ){\n        progress.hide();\n      } else {\n        progress.show();      \n      }\n    }\n  })(i);\n}\n\nlet isScrolling;\nlet scrollBreak = false;\n\n\ndocument.addEventListener('wheel', function( e ){\n  window.clearTimeout( isScrolling );\n  isScrolling = setTimeout(function() {\n\t\tscrollBreak = false;\n\t}, 200 );\n\n  if( !scrollBreak ){\n    currentScreen.scroll( e.deltaY );\n    currentScreen.update();\n  }\n  for( let i = 0; i < screens.length; i++ ){\n    if( screens[i].active ){\n      currentScreenIndex = i;\n      currentStageIndex = Math.floor( currentScreenIndex / 2 );\n      currentScreen = screens[i];\n    }\n  }\n\n  if( currentScreenIndex !== pScreenIndex ){\n    progress.setCurrent( currentScreen, currentStageIndex );\n    scrollBreak = true;\n  }\n  \n  pScreenIndex = currentScreenIndex;\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kdWxlcy9WaWRlby5qcz85ZDdiIiwid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL1NjcmVlbi5qcz8zYTg0Iiwid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL1Byb2dyZXNzLmpzPzJiZTIiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvQ29udHJvbHMuanM/M2NkZSIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi5qcz81NmQ3Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw2QztBQUNBO0FBQ0EsMkM7QUFDQTtBQUNBO0FBQ0Esa0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7QUFDZSx1REFBSyxFOztBQ3RHVzs7QUFFL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsd0I7QUFDQSxxQkFBcUIsYUFBSztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFD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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHdCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsb0JBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vZW5zdXJlIDxzY3JpcHQgc3JjPVwiaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL2FwaS9wbGF5ZXIuanNcIj48L3NjcmlwdD4gaXMgaW5jbHVkZWQgb24gcGFnZVxuXG5sZXQgVmlkZW8gPSBmdW5jdGlvbiggaWQsICRlbGUgKXtcbiAgbGV0IG9wdHMgPSB7XG4gICAgaWQ6IGlkLFxuICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgICBhdXRvcGxheTogZmFsc2UsXG4gICAgY29udHJvbHM6IGZhbHNlLFxuICAgIG11dGVkOiB0cnVlXG4gIH07XG4gIHRoaXMudmltZW8gPSBuZXcgVmltZW8uUGxheWVyKCAkZWxlLCBvcHRzICk7XG4gIHRoaXMudm9sdW1lID0gMDtcbiAgdGhpcy52aW1lby5zZXRWb2x1bWUoIHRoaXMudm9sdW1lICk7XG4gIHRoaXMucHJvZ3Jlc3MgPSAwO1xuICB0aGlzLmxlbmd0aCA9IDA7XG4gIHRoaXMudmltZW8uZ2V0RHVyYXRpb24oKS50aGVuKGR1cmF0aW9uID0+IHRoaXMubGVuZ3RoID0gZHVyYXRpb24pOyAgXG4gIHRoaXMuZmFkZUxvb3AgPSBmYWxzZTtcbiAgdGhpcy52aW1lby5vbignZW5kZWQnLCAoICkgPT4ge1xuICAgIHRoaXMuX29uRW5kZWQoKTtcbiAgfSk7XG4gIHRoaXMudmltZW8ub24oJ3RpbWV1cGRhdGUnLCAoIHQgKSA9PiB7XG4gICAgdGhpcy5wcm9ncmVzcyA9IHQuc2Vjb25kcyAvIHQuZHVyYXRpb247XG4gICAgaWYoIHR5cGVvZiB0aGlzLm9uUHJvZ3Jlc3MgPT09ICdmdW5jdGlvbicgKXtcbiAgICAgIHRoaXMub25Qcm9ncmVzcygpO1xuICAgIH1cbiAgICBpZiggdC5zZWNvbmRzID49IHQuZHVyYXRpb24gLSAyICl7XG4gICAgICB0aGlzLl9vbkVuZGVkKCk7XG4gICAgfVxuICB9KTtcbn1cblxubGV0IHByb3RvID0gVmlkZW8ucHJvdG90eXBlO1xuXG5wcm90by5fb25FbmRlZCA9IGZ1bmN0aW9uKCl7XG4gIGlmKCB0eXBlb2YgdGhpcy5vbkVuZGVkID09PSAnZnVuY3Rpb24nICl7XG4gICAgdGhpcy5vbkVuZGVkKCk7XG4gIH1cbn1cblxucHJvdG8ucGxheSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMudmltZW8ucGxheSgpO1xufVxuXG5wcm90by5wYXVzZSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMudmltZW8ucGF1c2UoKTtcbn1cblxucHJvdG8uZ2V0UHJvZ3Jlc3MgPSBmdW5jdGlvbigpe1xuICByZXR1cm4gdGhpcy5wcm9ncmVzcztcbn1cblxucHJvdG8uX29uRmFkZWRJbiA9IGZ1bmN0aW9uKCl7XG4gIGlmKCB0eXBlb2YgdGhpcy5vbkZhZGVkSW4gPT09ICdmdW5jdGlvbicgKXtcbiAgICB0aGlzLm9uRmFkZWRJbigpO1xuICB9XG59XG5cbnByb3RvLmZhZGVJbiA9IGZ1bmN0aW9uKCBfdGltZSwgX2NhbGxiYWNrICl7ICBcbiAgbGV0IHRpbWUgPSBfdGltZSB8fCAxMDA7XG4gIGxldCBjYWxsYmFjayA9IF9jYWxsYmFjayB8fCBmdW5jdGlvbigpe307XG4gIGNsZWFySW50ZXJ2YWwoIHRoaXMuZmFkZUxvb3AgKTtcbiAgbGV0IGNoYW5nZSA9IDEgLSB0aGlzLnZvbHVtZTtcbiAgbGV0IHN0ZXAgPSBjaGFuZ2UgLyAodGltZSAvIDEwKTtcbiAgdGhpcy5mYWRlTG9vcCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICB0aGlzLnZvbHVtZSArPSBzdGVwO1xuICAgIGlmKCB0aGlzLnZvbHVtZSA+PSAxICl7XG4gICAgICB0aGlzLnZvbHVtZSA9IDE7IFxuICAgICAgdGhpcy5fb25GYWRlZEluKCk7XG4gICAgICBjYWxsYmFjaygpO1xuICAgICAgY2xlYXJJbnRlcnZhbCggdGhpcy5mYWRlTG9vcCApO1xuICAgIH0gICAgXG4gICAgdGhpcy52aW1lby5zZXRWb2x1bWUoIHRoaXMudm9sdW1lICk7XG4gIH0sIDEwICk7XG59O1xuXG5wcm90by5fb25GYWRlZE91dCA9IGZ1bmN0aW9uKCl7XG4gIGlmKCB0eXBlb2YgdGhpcy5vbkZhZGVkT3V0ID09PSAnZnVuY3Rpb24nICl7XG4gICAgdGhpcy5vbkZhZGVkT3V0KCk7XG4gIH1cbn1cblxucHJvdG8uZmFkZU91dCA9IGZ1bmN0aW9uKCBfdGltZSwgX2NhbGxiYWNrICl7ICBcbiAgbGV0IHRpbWUgPSBfdGltZSB8fCAxMDA7XG4gIGxldCBjYWxsYmFjayA9IF9jYWxsYmFjayB8fCBmdW5jdGlvbigpe307ICBcbiAgY2xlYXJJbnRlcnZhbCggdGhpcy5mYWRlTG9vcCApO1xuICBsZXQgY2hhbmdlID0gLXRoaXMudm9sdW1lO1xuICBsZXQgc3RlcCA9IGNoYW5nZSAvICh0aW1lIC8gMTApOyAgXG4gIHRoaXMuZmFkZUxvb3AgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgdGhpcy52b2x1bWUgKz0gc3RlcDtcbiAgICBpZiggdGhpcy52b2x1bWUgPD0gMCApe1xuICAgICAgdGhpcy52b2x1bWUgPSAwOyBcbiAgICAgIHRoaXMuX29uRmFkZWRPdXQoKTtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgICBjbGVhckludGVydmFsKCB0aGlzLmZhZGVMb29wICk7XG4gICAgfVxuICAgIHRoaXMudmltZW8uc2V0Vm9sdW1lKCB0aGlzLnZvbHVtZSApO1xuICB9LCAxMCApO1xufTtcblxucHJvdG8udXBkYXRlID0gZnVuY3Rpb24oIGZyYWN0aW9uICl7XG5cbn1cbmV4cG9ydCBkZWZhdWx0IFZpZGVvOyIsImltcG9ydCBWaWRlbyBmcm9tIFwiLi9WaWRlby5qc1wiO1xuXG5sZXQgU2NyZWVuID0gZnVuY3Rpb24oICRlbGUgKXtcbiAgdGhpcy4kZWxlID0gJGVsZTtcbiAgdGhpcy4kY29udGVudCA9ICRlbGUucXVlcnlTZWxlY3RvcignLnNjcmVlbi0tY29udGVudCcpO1xuICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICB0aGlzLnR5cGUgPSAnJztcbiAgaWYoIHRoaXMuJGVsZS5jbGFzc0xpc3QuY29udGFpbnMoICdzY3JlZW5fX3RleHRfX2NyZWRpdHMnICkgKXtcbiAgICAgIHRoaXMudHlwZSA9ICdjcmVkaXRzJztcbiAgfSBlbHNlIGlmKCB0aGlzLiRlbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCAnc2NyZWVuX192aWRlbycgKSApe1xuICAgIHRoaXMudHlwZSA9ICd2aWRlbyc7ICAgIFxuICAgIHRoaXMudmlkZW8gPSBuZXcgVmlkZW8oIHRoaXMuJGNvbnRlbnQuZGF0YXNldC52aW1lb19pZCwgdGhpcy4kY29udGVudCApO1xuICAgIHRoaXMudmlkZW8ub25Qcm9ncmVzcyA9ICgpID0+IHtcbiAgICAgIHRoaXMuX29uUHJvZ3Jlc3MoKTtcbiAgICB9O1xuICAgIHRoaXMudmlkZW8ub25FbmRlZCA9ICgpID0+IHtcbiAgICAgIHRoaXMuZGVhY3RpdmF0ZSgpO1xuICAgICAgdGhpcy5zY3JlZW5BZnRlci5hY3RpdmF0ZSgpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLnR5cGUgPSAndGV4dCc7XG4gIH1cbiAgdGhpcy5zY3JvbGxQcm9ncmVzcyA9IDA7XG4gIHRoaXMuc2Nyb2xsUHJvZ3Jlc3NGcmFjID0gMDtcbiAgdGhpcy5zY3JvbGxNYXggPSAoIHRoaXMudHlwZSA9PT0gJ2NyZWRpdHMnICkgPyB0aGlzLiRlbGUuc2Nyb2xsSGVpZ2h0IDogdGhpcy4kZWxlLm9mZnNldEhlaWdodCowLjY1OyAgXG4gIHRoaXMuc2Nyb2xsTWluID0gKCB0aGlzLnR5cGUgPT09ICdjcmVkaXRzJyApID8gdGhpcy4kZWxlLm9mZnNldEhlaWdodCAqIC0wLjEgOiAwO1xufVxuXG5sZXQgcHJvdG8gPSBTY3JlZW4ucHJvdG90eXBlO1xuXG5wcm90by5saW5rVG9PdGhlcnMgPSBmdW5jdGlvbiggYmVmb3JlLCBhZnRlciApe1xuICB0aGlzLnNjcmVlbkJlZm9yZSA9IGJlZm9yZTtcbiAgdGhpcy5zY3JlZW5BZnRlciA9IGFmdGVyO1xufVxuXG5wcm90by5fb25Qcm9ncmVzcyA9IGZ1bmN0aW9uKCl7XG4gIGlmKCB0eXBlb2YgdGhpcy5vblByb2dyZXNzID09PSAnZnVuY3Rpb24nICYmIHRoaXMuYWN0aXZlICl7XG4gICAgdGhpcy5vblByb2dyZXNzKCk7XG4gIH1cbn1cblxucHJvdG8uX29uQWN0aXZhdGVkID0gZnVuY3Rpb24oKXtcbiAgaWYoIHR5cGVvZiB0aGlzLm9uQWN0aXZhdGVkID09PSAnZnVuY3Rpb24nICl7XG4gICAgdGhpcy5vbkFjdGl2YXRlZCggdGhpcyApO1xuICB9XG59XG5cbnByb3RvLl9vbkFjdGl2YXRlU3RhcnQgPSBmdW5jdGlvbigpe1xuICBpZiggdHlwZW9mIHRoaXMub25BY3RpdmF0ZVN0YXJ0ID09PSAnZnVuY3Rpb24nICl7XG4gICAgdGhpcy5vbkFjdGl2YXRlU3RhcnQoIHRoaXMgKTtcbiAgfVxufVxuXG5wcm90by5wcmVsb2FkID0gZnVuY3Rpb24oKXtcbiAgaWYoIHRoaXMudHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgIHRoaXMudmlkZW8ucGxheSgpOyAgICBcbiAgfVxufVxuXG5wcm90by5hY3RpdmF0ZSA9IGZ1bmN0aW9uKCBfY2FsbGJhY2sgKXtcbiAgbGV0IGNhbGxiYWNrID0gX2NhbGxiYWNrIHx8IGZ1bmN0aW9uKCl7fTtcbiAgdGhpcy5fb25BY3RpdmF0ZVN0YXJ0KCk7XG4gIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgdGhpcy4kZWxlLmNsYXNzTGlzdC5hZGQoICdhY3RpdmUnICk7XG4gIHRoaXMuc2Nyb2xsUHJvZ3Jlc3MgPSAwO1xuICB0aGlzLnNjcm9sbFByb2dyZXNzRnJhYyA9IDA7ICBcbiAgaWYoIHRoaXMudHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgIHRoaXMudmlkZW8ucGxheSgpO1xuICAgIHRoaXMudmlkZW8uZmFkZUluKDE1MDAsICgpID0+IHtcbiAgICAgIHRoaXMuX29uQWN0aXZhdGVkKCk7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH0pOyAgICBcbiAgfSBlbHNlIGlmKCB0aGlzLnR5cGUgPT09ICdjcmVkaXRzJyApe1xuICAgIHRoaXMuJGNvbnRlbnQuc2Nyb2xsVG9wID0gMDtcbiAgICB0aGlzLl9vbkFjdGl2YXRlZCgpO1xuICAgIGNhbGxiYWNrKCk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5fb25BY3RpdmF0ZWQoKTtcbiAgICBjYWxsYmFjaygpO1xuICB9XG4gIHRoaXMudXBkYXRlKCk7XG59XG5cbnByb3RvLmRlYWN0aXZhdGUgPSBmdW5jdGlvbiggX2NhbGxiYWNrICl7XG4gIGxldCBjYWxsYmFjayA9IF9jYWxsYmFjayB8fCBmdW5jdGlvbigpe307XG4gIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gIHRoaXMuJGVsZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgaWYoIHRoaXMudHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgIHRoaXMudmlkZW8uZmFkZU91dCggMTUwMCwgKCkgPT4ge1xuICAgICAgdGhpcy52aWRlby5wYXVzZSgpO1xuICAgICAgY2FsbGJhY2soKTtcbiAgICB9KTtcbiAgfSBlbHNle1xuICAgIGNhbGxiYWNrKCk7XG4gIH1cbn1cblxuXG5wcm90by5zY3JvbGwgPSBmdW5jdGlvbiggZGVsdGEgKXtcbiAgaWYoIHRoaXMuYWN0aXZlICl7XG4gICAgdGhpcy5zY3JvbGxQcm9ncmVzcyArPSBkZWx0YTtcbiAgICBpZiggdGhpcy5zY3JvbGxQcm9ncmVzcyA8IHRoaXMuc2Nyb2xsTWluIC0xMCApe1xuICAgICAgdGhpcy5zY3JvbGxQcm9ncmVzcyA9IHRoaXMuc2Nyb2xsTWluIC0xMDtcbiAgICB9IGVsc2UgaWYoIHRoaXMuc2Nyb2xsUHJvZ3Jlc3MgPiB0aGlzLnNjcm9sbE1heCArIDEwICl7XG4gICAgICB0aGlzLnNjcm9sbFByb2dyZXNzID0gdGhpcy5zY3JvbGxNYXggKyAxMDtcbiAgICB9XG4gICAgdGhpcy5zY3JvbGxQcm9ncmVzc0ZyYWMgPSB0aGlzLnNjcm9sbFByb2dyZXNzL3RoaXMuc2Nyb2xsTWF4O1xuICAgIGlmKCB0aGlzLnNjcm9sbFByb2dyZXNzRnJhYyA+IDAuNzUgJiYgdGhpcy5zY3JlZW5BZnRlciApe1xuICAgICAgdGhpcy5kZWFjdGl2YXRlKCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2NyZWVuQWZ0ZXIuYWN0aXZhdGUoKTtcbiAgICAgIH0pOyAgICAgIFxuICAgIH0gZWxzZSBpZiggdGhpcy5zY3JvbGxQcm9ncmVzc0ZyYWMgPCB0aGlzLnNjcm9sbE1pbiAvIHRoaXMuc2Nyb2xsTWF4ICYmIHRoaXMuc2NyZWVuQmVmb3JlICl7XG4gICAgICB0aGlzLmRlYWN0aXZhdGUoICgpID0+IHtcbiAgICAgICAgdGhpcy5zY3JlZW5CZWZvcmUuYWN0aXZhdGUoKTtcbiAgICAgIH0pOyAgICAgIFxuICAgIH1cbiAgICBpZiggdGhpcy5zY3JvbGxQcm9ncmVzc0ZyYWMgPiAwLjI1ICYmIHRoaXMuc2NyZWVuQWZ0ZXIudHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgICAgdGhpcy5zY3JlZW5BZnRlci5wcmVsb2FkKCk7XG4gICAgfSBcbiAgfVxufVxuXG5wcm90by5yZXNpemUgPSBmdW5jdGlvbigpe1xuICB0aGlzLnNjcm9sbFByb2dyZXNzRnJhYyA9IHRoaXMuc2Nyb2xsUHJvZ3Jlc3MvdGhpcy5zY3JvbGxNYXg7XG4gIHRoaXMuc2Nyb2xsTWF4ID0gKCB0aGlzLnR5cGUgPT09ICdjcmVkaXRzJyApID8gdGhpcy4kZWxlLnNjcm9sbEhlaWdodCA6IHRoaXMuJGVsZS5vZmZzZXRIZWlnaHQ7XG4gIHRoaXMuc2Nyb2xsUHJvZ3Jlc3MgPSB0aGlzLnNjcm9sbFByb2dyZXNzRnJhYyAqIHRoaXMuc2Nyb2xsTWF4O1xufVxuXG5wcm90by51cGRhdGUgPSBmdW5jdGlvbigpe1xuICBpZiggdGhpcy50eXBlID09PSAndmlkZW8nICl7XG4gICAgdGhpcy52aWRlby51cGRhdGUoIHRoaXMuc2Nyb2xsUHJvZ3Jlc3NGcmFjICk7XG4gICAgaWYoIHRoaXMuc2Nyb2xsUHJvZ3Jlc3NGcmFjID4gMC43NSApe1xuICAgICAgdGhpcy4kY29udGVudC5zdHlsZS5vcGFjaXR5ID0gKDAuMjUgLSAodGhpcy5zY3JvbGxQcm9ncmVzc0ZyYWMgLSAwLjc1KSkgKiAoMS8wLjI1KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kY29udGVudC5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy4kY29udGVudC5zdHlsZS5vcGFjaXR5ID0gKDEgLSB0aGlzLnNjcm9sbFByb2dyZXNzRnJhYyk7XG4gIH1cblxuICBcbn1cblxuZXhwb3J0IGRlZmF1bHQgU2NyZWVuOyIsImxldCBQcm9ncmVzcyA9IGZ1bmN0aW9uKCAkZWxlLCBjdXJyZW50U2NyZWVuLCBzdGFnZUluZGV4ICl7XG4gIHRoaXMuJGVsZSA9ICRlbGU7XG4gIHRoaXMuJGluZGljYXRvciA9IHRoaXMuJGVsZS5xdWVyeVNlbGVjdG9yKCcucHJvZ3Jlc3MtLWluZGljYXRvcicpO1xuICB0aGlzLiRzdGFnZXMgPSB0aGlzLiRlbGUucXVlcnlTZWxlY3RvckFsbCgnLnByb2dyZXNzLS1zdGFnZScpO1xuICB0aGlzLnNldEluZGljYXRvclRyYW5zaXRpb24oIGZhbHNlICk7XG4gIHRoaXMuc2V0Q3VycmVudCggY3VycmVudFNjcmVlbiwgc3RhZ2VJbmRleCApO1xuICB0aGlzLmluaXRJbnRlcmFjdGlvbigpO1xuICB0aGlzLmhpZGVUaW1lb3V0ID0gZmFsc2U7XG4gIHRoaXMuaGlkZURlbGF5ID0gMzAwMDtcbn1cblxubGV0IHByb3RvID0gUHJvZ3Jlc3MucHJvdG90eXBlO1xuXG5wcm90by5oaWRlID0gZnVuY3Rpb24oIGRlbGF5ICl7XG4gIGNsZWFyVGltZW91dCggdGhpcy5oaWRlVGltZW91dCApO1xuICBpZiggZGVsYXkgKXtcbiAgICB0aGlzLmhpZGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLiRlbGUuY2xhc3NMaXN0LmFkZCgnc3RhdGVfX2hpZGRlbicpO1xuICAgIH0sIGRlbGF5ICk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy4kZWxlLmNsYXNzTGlzdC5hZGQoJ3N0YXRlX19oaWRkZW4nKTtcbiAgfVxufVxucHJvdG8uc2hvdyA9IGZ1bmN0aW9uKCl7XG4gIGNsZWFyVGltZW91dCggdGhpcy5oaWRlVGltZW91dCApO1xuICB0aGlzLiRlbGUuY2xhc3NMaXN0LnJlbW92ZSgnc3RhdGVfX2hpZGRlbicpO1xufVxuXG5wcm90by5fb25TdGFnZVNlbGVjdCA9IGZ1bmN0aW9uKCBpbmRleCwgaWQgKXtcbiAgaWYoIHR5cGVvZiB0aGlzLm9uU3RhZ2VTZWxlY3QgPT09ICdmdW5jdGlvbicgKXtcbiAgICB0aGlzLm9uU3RhZ2VTZWxlY3QoIGluZGV4LCBpZCApO1xuICB9XG59XG5cbnByb3RvLmluaXRJbnRlcmFjdGlvbiA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMuJGVsZS5xdWVyeVNlbGVjdG9yQWxsKCdhJykuZm9yRWFjaCgoICRhLCBpICApID0+IHtcbiAgICAkYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGxldCBpZCA9ICRhLmhyZWYucmVwbGFjZSh3aW5kb3cubG9jYXRpb24ub3JpZ2luLCcnKS5yZXBsYWNlKCcvJywgJycpLnJlcGxhY2UoJyMnLCcnKTtcbiAgICAgIHRoaXMuX29uU3RhZ2VTZWxlY3QoIGksIGlkICk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKCkgPT4ge1xuICAgIGNsZWFyVGltZW91dCggdGhpcy5oaWRlVGltZW91dCApO1xuICAgIHRoaXMuc2hvdygpO1xuICAgIGlmKCB0aGlzLmN1cnJlbnRTY3JlZW4udHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgICAgdGhpcy5oaWRlKCB0aGlzLmhpZGVEZWxheSApO1xuICAgIH1cbiAgfSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKCBlICkgPT4ge1xuICAgIGNsZWFyVGltZW91dCggdGhpcy5oaWRlVGltZW91dCApO1xuICAgIHRoaXMuc2hvdygpO1xuICAgIGlmKCB0aGlzLmN1cnJlbnRTY3JlZW4udHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgICAgdGhpcy5oaWRlKCB0aGlzLmhpZGVEZWxheSApO1xuICAgIH1cbiAgfSk7XG59O1xuXG5wcm90by5zZXRDdXJyZW50ID0gZnVuY3Rpb24oIGN1cnJlbnRTY3JlZW4sIHN0YWdlSW5kZXggKXtcbiAgdGhpcy5jdXJyZW50U2NyZWVuID0gY3VycmVudFNjcmVlbjtcbiAgdGhpcy4kY3VycmVudFN0YWdlID0gdGhpcy4kc3RhZ2VzWyBzdGFnZUluZGV4IF07XG4gIHRoaXMubW92ZUluZGljYXRvcigpO1xuICBpZiggdGhpcy5jdXJyZW50U2NyZWVuLnR5cGUgPT09ICd2aWRlbycgKXtcbiAgICB0aGlzLmhpZGUoIHRoaXMuaGlkZURlbGF5ICk7XG4gICAgdGhpcy5jdXJyZW50U2NyZWVuLm9uUHJvZ3Jlc3MgPSAoKSA9PiB7XG4gICAgICB0aGlzLm1vdmVJbmRpY2F0b3IoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5zaG93KCk7XG4gIH1cbn1cblxucHJvdG8uc2V0SW5kaWNhdG9yVHJhbnNpdGlvbiA9IGZ1bmN0aW9uKCB0bywgZGVsYXkgKXtcbiAgY2xlYXJUaW1lb3V0KCB0aGlzLmluZGljYXRvclRyYW5zaXRpb25Ub2dnbGVUaW1lb3V0ICk7XG4gIGlmKCAhIWRlbGF5ICYmIGRlbGF5ID4gMCApe1xuICAgIHRoaXMuaW5kaWNhdG9yVHJhbnNpdGlvblRvZ2dsZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmKCB0byApe1xuICAgICAgICB0aGlzLiRpbmRpY2F0b3IuY2xhc3NMaXN0LmFkZCgndHJhbnNpdGlvbi1hY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuJGluZGljYXRvci5jbGFzc0xpc3QucmVtb3ZlKCd0cmFuc2l0aW9uLWFjdGl2ZScpO1xuICAgICAgfVxuICAgIH0sIGRlbGF5IClcbiAgfSBlbHNlIHtcbiAgICBpZiggdG8gKXtcbiAgICAgIHRoaXMuJGluZGljYXRvci5jbGFzc0xpc3QuYWRkKCd0cmFuc2l0aW9uLWFjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRpbmRpY2F0b3IuY2xhc3NMaXN0LnJlbW92ZSgndHJhbnNpdGlvbi1hY3RpdmUnKTtcbiAgICB9XG4gIH1cbiAgdGhpcy5pbmRpY2F0b3JUcmFuc2l0aW9uID0gdG87XG59XG5cbnByb3RvLm1vdmVJbmRpY2F0b3IgPSBmdW5jdGlvbigpe1xuICBsZXQgdHJhbnNsYXRlWCA9IDA7XG4gIGlmKCB0aGlzLmN1cnJlbnRTY3JlZW4udHlwZSA9PT0gJ3ZpZGVvJyApe1xuICAgIGxldCBwcm9ncmVzcyA9IHRoaXMuY3VycmVudFNjcmVlbi52aWRlby5nZXRQcm9ncmVzcygpO1xuICAgIGxldCB4ID0gdGhpcy4kY3VycmVudFN0YWdlLm9mZnNldExlZnQ7XG4gICAgbGV0IG1heCA9IHRoaXMuJGN1cnJlbnRTdGFnZS5vZmZzZXRXaWR0aDtcbiAgICB0cmFuc2xhdGVYID0geCArIChwcm9ncmVzcyAqIG1heCk7ICAgIFxuICB9IGVsc2Uge1xuICAgIHRyYW5zbGF0ZVggPSB0aGlzLiRjdXJyZW50U3RhZ2Uub2Zmc2V0TGVmdDtcbiAgfVxuICB0aGlzLiRpbmRpY2F0b3Iuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoJyArIHRyYW5zbGF0ZVggKyAncHgpJztcbn1cblxuZXhwb3J0IGRlZmF1bHQgUHJvZ3Jlc3M7IiwibGV0IENvbnRyb2xzID0gZnVuY3Rpb24oICRlbGUgKXtcbiAgdGhpcy4kZWxlID0gJGVsZTtcbiAgdGhpcy4kZnVsbHNjcmVlbiA9IHRoaXMuJGVsZS5xdWVyeVNlbGVjdG9yKCcuZnVsbHNjcmVlbicpO1xuICB0aGlzLiRtdXRlID0gdGhpcy4kZWxlLnF1ZXJ5U2VsZWN0b3IoJy5tdXRlJylcbiAgdGhpcy4kc3VicyA9IHRoaXMuJGVsZS5xdWVyeVNlbGVjdG9yKCcuc3VidGl0bGVzJylcblxuICB0aGlzLiRmdWxsc2NyZWVuLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgaWYgKCFkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCkge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNpdGUtd3JhcCcpXG4gICAgICAgIC5yZXF1ZXN0RnVsbHNjcmVlbih7IG5hdmlnYXRpb25VSTogXCJoaWRlXCIgfSlcbiAgICAgICAgLmNhdGNoKCAoIGVyciApID0+IHtcbiAgICAgICAgICBhbGVydCgnbm8gZnVsbHNjcmVlbicpO1xuICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xuICAgIH1cbiAgfSk7XG59XG5cblxuXG5sZXQgcHJvdG8gPSBDb250cm9scy5wcm90b3R5cGU7XG5cbmV4cG9ydCBkZWZhdWx0IENvbnRyb2xzOyIsImltcG9ydCBTY3JlZW4gZnJvbSBcIi4vbW9kdWxlcy9TY3JlZW4uanNcIjtcbmltcG9ydCBQcm9ncmVzcyBmcm9tIFwiLi9tb2R1bGVzL1Byb2dyZXNzLmpzXCI7XG5pbXBvcnQgQ29udHJvbHMgZnJvbSBcIi4vbW9kdWxlcy9Db250cm9scy5qc1wiO1xuXG5sZXQgc2NyZWVucyA9IFtdO1xuZG9jdW1lbnRcbiAgLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY3JlZW4nKVxuICAuZm9yRWFjaChmdW5jdGlvbiggJHMgKXtcbiAgICBzY3JlZW5zLnB1c2goIG5ldyBTY3JlZW4oICRzICkgKTtcbiAgfSk7XG5cbmZvciggbGV0IGkgPSAwOyBpIDwgc2NyZWVucy5sZW5ndGg7IGkrKyApe1xuICBsZXQgYmVmb3JlID0gaSA+IDAgPyBzY3JlZW5zW2ktMV0gOiBmYWxzZTtcbiAgbGV0IGFmdGVyID0gaSA8IHNjcmVlbnMubGVuZ3RoIC0gMSA/IHNjcmVlbnNbaSsxXSA6IGZhbHNlOyAgXG4gIHNjcmVlbnNbaV0ubGlua1RvT3RoZXJzKCBiZWZvcmUsIGFmdGVyICk7IFxufVxuXG53aW5kb3cuc2NyZWVucyA9IHNjcmVlbnM7XG5cbmxldCBjdXJyZW50U2NyZWVuSW5kZXggPSAwO1xubGV0IHBTY3JlZW5JbmRleCA9IDA7XG5sZXQgY3VycmVudFN0YWdlSW5kZXggPSBNYXRoLmZsb29yKCBjdXJyZW50U2NyZWVuSW5kZXggLyAyICk7XG5sZXQgY3VycmVudFNjcmVlbiA9IHNjcmVlbnNbY3VycmVudFNjcmVlbkluZGV4XTtcblxubGV0IHByb2dyZXNzID0gbmV3IFByb2dyZXNzKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZ3Jlc3MtLWJhcicpLCBjdXJyZW50U2NyZWVuICwgY3VycmVudFN0YWdlSW5kZXggKTtcbmxldCBjb250cm9scyA9IG5ldyBDb250cm9scyggZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzJykgKTtcblxuXG5sZXQgc3RhZ2VTZWxlY3RUaW1lb3V0ID0gZmFsc2U7XG5wcm9ncmVzcy5vblN0YWdlU2VsZWN0ID0gZnVuY3Rpb24oIGluZGV4LCBpZCApe1xuICBpZiggaW5kZXggIT09IGN1cnJlbnRTdGFnZUluZGV4ICl7XG4gICAgY2xlYXJUaW1lb3V0KHN0YWdlU2VsZWN0VGltZW91dCk7XG4gICAgY3VycmVudFNjcmVlbi5kZWFjdGl2YXRlKCk7XG4gICBcbiAgICBzdGFnZVNlbGVjdFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICBjdXJyZW50U2NyZWVuSW5kZXggPSBpbmRleCAqIDI7XG4gICAgICBjdXJyZW50U3RhZ2VJbmRleCA9IGluZGV4O1xuICAgICAgY3VycmVudFNjcmVlbiA9IHNjcmVlbnNbY3VycmVudFNjcmVlbkluZGV4XTtcbiAgICAgIGN1cnJlbnRTY3JlZW4uYWN0aXZhdGUoKTtcbiAgICAgIHByb2dyZXNzLnNldEluZGljYXRvclRyYW5zaXRpb24oIHRydWUgKTtcbiAgICAgIHByb2dyZXNzLnNldEN1cnJlbnQoIGN1cnJlbnRTY3JlZW4sIGN1cnJlbnRTdGFnZUluZGV4ICk7XG4gICAgICBwcm9ncmVzcy5zZXRJbmRpY2F0b3JUcmFuc2l0aW9uKCBmYWxzZSwgMTUwMCApO1xuICAgIH0sIDMwMCApO1xuICB9XG59XG5cbmN1cnJlbnRTY3JlZW4uYWN0aXZhdGUoKTtcblxuZm9yKCBsZXQgaSA9IDA7IGkgPCBzY3JlZW5zLmxlbmd0aDsgaSsrICl7XG4gIHNjcmVlbnNbaV0udXBkYXRlKCk7XG4gIChmdW5jdGlvbiggaW5kZXggKXtcbiAgICBzY3JlZW5zW2luZGV4XS5vbkFjdGl2YXRlU3RhcnQgPSBmdW5jdGlvbiggcyApe1xuICAgICAgbGV0IHByZXZpb3VzU2NyZWVuID0gY3VycmVudFNjcmVlbjtcbiAgICAgIGN1cnJlbnRTY3JlZW5JbmRleCA9IGluZGV4O1xuICAgICAgY3VycmVudFN0YWdlSW5kZXggPSBNYXRoLmZsb29yKCBjdXJyZW50U2NyZWVuSW5kZXggLyAyICk7XG4gICAgICBjdXJyZW50U2NyZWVuID0gc2NyZWVuc1tpbmRleF07XG4gICAgICBpZiggcHJldmlvdXNTY3JlZW4gJiYgcHJldmlvdXNTY3JlZW4udHlwZSA9PT0gJ3ZpZGVvJyAmJiBjdXJyZW50U2NyZWVuLnR5cGUgIT09ICd2aWRlbycpe1xuICAgICAgICBwcm9ncmVzcy5zZXRJbmRpY2F0b3JUcmFuc2l0aW9uKCB0cnVlICk7XG4gICAgICAgIHByb2dyZXNzLnNldEluZGljYXRvclRyYW5zaXRpb24oIGZhbHNlLCAxNTAwICk7XG4gICAgICB9XG4gICAgICBwcm9ncmVzcy5zZXRDdXJyZW50KCBjdXJyZW50U2NyZWVuLCBjdXJyZW50U3RhZ2VJbmRleCApO1xuICAgIH07XG4gICAgc2NyZWVuc1tpbmRleF0ub25BY3RpdmF0ZWQgPSBmdW5jdGlvbiggcyApe1xuICAgICAgICAgXG4gICAgICBpZiggcy50eXBlID09PSAndmlkZW8nICl7XG4gICAgICAgIHByb2dyZXNzLmhpZGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2dyZXNzLnNob3coKTsgICAgICBcbiAgICAgIH1cbiAgICB9XG4gIH0pKGkpO1xufVxuXG5sZXQgaXNTY3JvbGxpbmc7XG5sZXQgc2Nyb2xsQnJlYWsgPSBmYWxzZTtcblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIGZ1bmN0aW9uKCBlICl7XG4gIHdpbmRvdy5jbGVhclRpbWVvdXQoIGlzU2Nyb2xsaW5nICk7XG4gIGlzU2Nyb2xsaW5nID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRzY3JvbGxCcmVhayA9IGZhbHNlO1xuXHR9LCAyMDAgKTtcblxuICBpZiggIXNjcm9sbEJyZWFrICl7XG4gICAgY3VycmVudFNjcmVlbi5zY3JvbGwoIGUuZGVsdGFZICk7XG4gICAgY3VycmVudFNjcmVlbi51cGRhdGUoKTtcbiAgfVxuICBmb3IoIGxldCBpID0gMDsgaSA8IHNjcmVlbnMubGVuZ3RoOyBpKysgKXtcbiAgICBpZiggc2NyZWVuc1tpXS5hY3RpdmUgKXtcbiAgICAgIGN1cnJlbnRTY3JlZW5JbmRleCA9IGk7XG4gICAgICBjdXJyZW50U3RhZ2VJbmRleCA9IE1hdGguZmxvb3IoIGN1cnJlbnRTY3JlZW5JbmRleCAvIDIgKTtcbiAgICAgIGN1cnJlbnRTY3JlZW4gPSBzY3JlZW5zW2ldO1xuICAgIH1cbiAgfVxuXG4gIGlmKCBjdXJyZW50U2NyZWVuSW5kZXggIT09IHBTY3JlZW5JbmRleCApe1xuICAgIHByb2dyZXNzLnNldEN1cnJlbnQoIGN1cnJlbnRTY3JlZW4sIGN1cnJlbnRTdGFnZUluZGV4ICk7XG4gICAgc2Nyb2xsQnJlYWsgPSB0cnVlO1xuICB9XG4gIFxuICBwU2NyZWVuSW5kZXggPSBjdXJyZW50U2NyZWVuSW5kZXg7XG59KTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n")}]);